# 📅 Calendar Free Time Finder

最大5名のメンバーのGoogleカレンダーを比較し、共通の空き時間を瞬時に見つけるChrome拡張機能です。

## 主な機能

- **最大5名の空き時間検索** — メンバーのメールアドレスを入力するだけで、全員が空いている時間帯を自動で抽出
- **2つの表示モード** — リスト表示（時系列）とグリッド表示（ヒートマップ）を切り替え可能
- **ワンクリック予約** — 空き時間からそのままGoogleカレンダーの予定作成画面を開ける
- **プリセット保存** — よく使うチーム構成を名前をつけて保存。ワンタップで切り替え
- **除外キーワード** — 「ランチ」「移動時間」「作業ブロック」など、指定キーワードを含む予定を空きとして扱う
- **未回答・仮承諾の扱い** — カレンダーの参加未回答・仮承諾の予定を「予定あり」に含めるか選択可能
- **メールアドレスサジェスト** — 過去に入力したアドレスを自動記憶し、次回から候補表示
- **自動保存・復元** — 前回の入力内容を自動で保存・復元

## スクリーンショット

<!-- スクリーンショットがあればここに追加 -->
<!-- ![メイン画面](screenshot.png) -->

## セットアップ

### 前提条件

- Google Chrome ブラウザ（バージョン88以上）
- Google Cloud Console へのアクセス権
- Google Workspace アカウント（社内利用の場合）

### 1. Google Cloud プロジェクトの設定

1. [Google Cloud Console](https://console.cloud.google.com/) にアクセス
2. 新しいプロジェクトを作成（または既存プロジェクトを選択）
3. 「APIとサービス」→「ライブラリ」から **Google Calendar API** を有効化
4. 「APIとサービス」→「OAuth同意画面」を設定
   - ユーザータイプ: **内部**（同じWorkspace組織内のユーザーのみ利用する場合）
   - アプリ名・サポートメールを入力
   - スコープに以下を追加:
     - `https://www.googleapis.com/auth/calendar.readonly`
     - `https://www.googleapis.com/auth/calendar.freebusy`
5. 「APIとサービス」→「認証情報」→「認証情報を作成」→ **OAuth 2.0 クライアントID**
   - アプリケーションの種類: **Chrome拡張機能**
   - 拡張機能ID: （次のステップで取得）

### 2. 拡張機能のインストール

1. このリポジトリをクローンまたはダウンロード
   ```bash
   git clone https://github.com/your-repo/calendar-free-time-finder.git
   ```
2. Chromeで `chrome://extensions` を開く
3. 右上の「デベロッパーモード」をONにする
4. 「パッケージ化されていない拡張機能を読み込む」をクリックし、プロジェクトフォルダを選択
5. 表示された**拡張機能ID**をコピー
6. Google Cloud Consoleに戻り、OAuth認証情報の拡張機能IDにペースト
7. 取得したクライアントIDを `manifest.json` の `oauth2.client_id` に設定
8. `chrome://extensions` で拡張機能を「更新」

### 3. 社内配布

- **Chrome Web Store（内部公開）**: CWSデベロッパーアカウントから「限定公開」または組織内公開で配布。同じWorkspace組織のユーザーは追加のOAuth設定不要
- **直接配布**: `.crx` ファイルまたはフォルダを共有し、デベロッパーモードで読み込んでもらう

## 使い方

1. **ログイン** — ツールバーの拡張機能アイコンをクリック → 「Googleアカウントでログイン」
2. **メンバー入力** — 空き時間を調べたいメンバーのメールアドレスを入力（2〜5名）
3. **設定を調整** — 検索期間・営業時間・最短スロットなどを必要に応じて変更
4. **検索** — 「🔍 空き時間を検索」ボタンをクリック
5. **結果確認**
   - **リスト表示**: 日付ごとに空き時間を一覧表示。「📅 予約」ボタンでGoogleカレンダーへ
   - **グリッド表示**: 30分刻みのヒートマップ。緑=全員空き、黄=一部空き、赤=全員予定あり。緑セルをクリックで予約

## 設定項目

| 設定 | 選択肢 | デフォルト | 説明 |
|------|--------|-----------|------|
| 期間 | 1週間 / 2週間 / 1ヶ月 | 2週間 | 検索対象の日数 |
| 営業時間（開始） | 8:00 / 9:00 / 10:00 | 9:00 | 空き時間の検索開始時刻 |
| 営業時間（終了） | 17:00〜21:00 | 18:00 | 空き時間の検索終了時刻 |
| 最短スロット | 15分 / 30分 / 60分 | 30分 | これより短い空き時間は非表示 |
| 除外キーワード | カンマ区切りで自由入力 | なし | 含む予定を空きとして扱う |
| 未回答・仮承諾 | チェックON/OFF | ON | ONなら未回答・仮承諾も予定ありとして扱う |

## 技術スタック

| 項目 | 技術 |
|------|------|
| マニフェスト | Chrome Extension Manifest V3 |
| フロントエンド | HTML / CSS / Vanilla JavaScript |
| API | Google Calendar API v3（Events + FreeBusy） |
| 認証 | OAuth 2.0（Chrome Identity API） |
| データ保存 | Chrome Storage API（ローカル） |

## ファイル構成

```
calendar-free-time-finder/
├── manifest.json            # 拡張機能の設定・OAuth認証情報
├── popup.html               # メインUI（ログイン・設定・結果表示）
├── popup.js                 # アプリケーションロジック
├── popup.css                # スタイルシート
├── background.js            # Service Worker（認証管理）
├── privacy-policy.html      # プライバシーポリシー
├── icons/
│   ├── icon16.png           # ツールバーアイコン
│   ├── icon48.png           # 拡張機能管理画面用
│   └── icon128.png          # Chrome Web Store用
├── SETUP.md                 # 開発者向けセットアップ手順
└── screenshot-cws-1280x800.png  # CWS掲載用スクリーンショット
```

## プライバシー

- すべてのデータはブラウザのローカルストレージに保存され、外部サーバーには一切送信しません
- Google Calendar APIへのリクエストはブラウザから直接Googleのサーバーに送信されます
- 拡張機能をアンインストールすると、保存データもすべて削除されます
- 詳細は [privacy-policy.html](privacy-policy.html) を参照してください

## ライセンス

MIT License
